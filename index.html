<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ä¸æƒ³çœ‹ç‰‡</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EğŸ˜ˆ%3C/text%3E%3C/svg%3E">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC&family=Zhi+Mang+Xing&display=swap">
    <style>
        :root{
            --primary:#fff;
            --background:#0b1220;
            --accent:#ff5630;
            --muted:rgba(52,54,70,0.5);
            --button-hover:#353949;
            --outline:#ff56309c;
            --fixed:#ff5630;
            --page-max-width:1200px;
            --page-padding-x:clamp(16px,4vw,40px);
            --title-width:clamp(260px,56%,760px);
        }

        * { box-sizing: border-box; }
        html, body { height: 100%; }

        /* å…¨ç«™ï¼ˆé™¤æ ‡é¢˜å¤–ï¼‰é»˜è®¤å­—ä½“ä¸º LXGW WenKai TC */
        body{
            margin:0;
            /* ç»Ÿä¸€ä¸ºæš—é»‘è‰²å¤œç©ºèƒŒæ™¯ */
            background-color: var(--background);
            color:var(--primary);
            font-family:"LXGW WenKai TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            min-height:100vh;
            display:flex;
            flex-direction:column;
            overflow-x:hidden;
        }

        /* æ ‡é¢˜å•ç‹¬ä½¿ç”¨ Zhi Mang Xingï¼ˆä»…ç”¨äº header.title-boxï¼‰ */
        header.title-box {
            font-family: "Zhi Mang Xing", "LXGW WenKai TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            font-size:2.6rem;
            font-weight:700;
            letter-spacing:3px;
            margin-top:64px;
            margin-bottom:4px;
            line-height:0.85;
            text-align:center;
            width:var(--title-width);
            margin-inline:auto;
        }

        /* å…¨å±€è¶…é“¾æ¥æ–‡å­—é¢œè‰²ç»Ÿä¸€ */
        a { color: #9e9eff; }

        #starfield{position:fixed;inset:0;width:100%;height:100%;z-index:0;pointer-events:none}

        .container{
            flex:1;
            display:flex;
            flex-direction:column;
            width:100%;
            max-width:var(--page-max-width);
            margin-inline:auto;
            padding-left:var(--page-padding-x);
            padding-right:var(--page-padding-x);
            align-items:center;
            position:relative;
            z-index:1;
        }

        .banner{width:100%;display:flex;flex-direction:column;align-items:center;margin-bottom:14px}
        .banner h2{font-size:1.3rem;font-weight:600;margin-bottom:8px;color:var(--accent);text-align:center}
        .banner a{color:#9e9eff}

        /* åˆ†ç±»æŒ‰é’®ç¡®ä¿ä½¿ç”¨ LXGW WenKai TCï¼ˆæŒ‰é’®æ–‡å­—ä¹Ÿè¦ç”¨è¯¥å­—ä½“ï¼‰ */
        .category-btns{display:flex;gap:14px;margin-bottom:16px;justify-content:center;width:100%}
        .category-btn{
            font-family:"LXGW WenKai TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            min-width:86px;padding:10px 22px;font-size:1.01rem;border-radius:22px;
            background:var(--muted);color:var(--primary);border:none;cursor:pointer;font-weight:600;
            transition:background .18s,color .18s,transform .14s;outline:2px solid transparent;
        }
        .category-btn:hover{background:var(--button-hover);color:var(--accent);transform:translateY(-2px) scale(1.03)}
        .category-btn.active{background:rgba(255,86,48,0.5);color:var(--background);outline:2px solid var(--fixed)}

        .grid-wrapper{width:100%;position:relative;margin:8px 0;min-height:150px}
        .site-grid{
            width:100%;display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
            gap:22.2px 8.8px;justify-items:center;align-items:start;min-height:150px;transition:opacity 220ms ease,transform 220ms ease;position:relative;z-index:1;
        }
        .site-grid.faded{opacity:0;pointer-events:none}

        .site-card{
            background:var(--muted);border-radius:17px;box-shadow:0 2px 8px rgba(20,24,32,0.09);
            padding:17.8px 22.6px;width:80.75%;min-height:76px;display:flex;flex-direction:column;align-items:center;position:relative;cursor:pointer;transition:transform .3s ease,box-shadow .2s ease;
        }
        .site-card:hover{transform:scale(1.2);box-shadow:0 8px 15px rgba(0,0,0,0.2)}

        .site-name{
            font-family:"LXGW WenKai TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            font-weight:600;margin-bottom:13px;text-align:center;background:none;border:none;color:inherit;cursor:pointer;transition:color .17s;font-size:1.296rem;text-decoration:none;display:inline-block;padding:0
        }
        .site-name:hover{color:var(--accent);text-decoration:underline}

        .backup-link-btn,.backup-none-btn{
            font-family:"LXGW WenKai TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            padding:7px 16px;font-size:.97rem;border:2px solid var(--outline);border-radius:13px;background:transparent;outline:none;cursor:pointer;transition:background .2s,color .15s,border-color .17s;text-decoration:none;display:inline-block;margin-top:6px;
        }

        /* å¤‡ä»½æŒ‰é’®é»˜è®¤éµå¾ªå…¨å±€ a é¢œè‰²ï¼Œä½†å¡ç‰‡å†…çš„â€œå¤‡ä»½ç½‘å€â€æ–‡å­—ç‰¹æ„å¼ºè°ƒä¸º --accent (#ff5630) */
        .backup-link-btn, .backup-none-btn { color: #9e9eff; }
        .site-card .backup-link-btn { color: var(--accent); }

        .backup-link-btn:hover,.backup-none-btn:hover{background:var(--accent);color:var(--background);border-color:var(--fixed);transform:translateY(-2px) scale(1.04)}
        .backup-none-btn{color:#b6b2b2;border-color:var(--outline)}

        .emby-box{position:absolute;inset:0;display:none;z-index:2;align-items:center;justify-content:center;padding:18px;box-sizing:border-box}
        .emby-box .card{
            width:100%;max-width:980px;background:transparent;border-radius:0;border:none;padding:clamp(14px,2.2vw,28px);
            color:#f6f4f6;box-shadow:none;display:flex;flex-direction:column;gap:10px;text-align:left;
            font-family:"LXGW WenKai TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            font-size:clamp(1.15rem,2vw,1.28rem);line-height:1.55
        }
        .emby-box h3{margin:0;font-size:clamp(1.05rem,2.4vw,1.28rem);color:var(--accent);letter-spacing:.6px}
        .emby-box p{margin:0;color:#d7d4d8}
        .emby-box ul{margin:0 0 0 1.2em;color:#d0cdd1}
        .emby-box small{color:#bcb8c0}
        .emby-box.show{display:flex}

        .notes{
            display:flex;justify-content:center;align-items:center;width:100%;text-align:center;font-size:.98rem;color:#bcb8c0;margin:4px 0;line-height:1.7;
            font-family:"LXGW WenKai TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        .centered-backup-btn{
            width:100%;text-align:center;margin:6px 0;display:flex;justify-content:center;align-items:center;gap:12px;
        }
        .backup-btn-large{
            padding:6.44px 14.8px;font-size:.89rem;color:var(--accent);border:2px solid var(--accent);background:transparent;border-radius:28px;outline:none;cursor:pointer;transition:background .18s,color .18s;
            font-family:"LXGW WenKai TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        .backup-btn-large:hover{background:var(--accent);color:var(--background)}

        footer{background-color: var;margin-top:6px;width:100%;text-align:center;color:#929099;font-size:1rem;padding:18px 0 13px 0;letter-spacing:1px}
        footer a{color:var(--accent);text-decoration:none;margin-left:10px}

        ::-webkit-scrollbar{width:8px;background:var(--muted)}
        ::-webkit-scrollbar-thumb{background:rgba(52,54,70,0.5);border-radius:6px}

        @media screen and (max-width:900px){
            .site-grid{grid-template-columns:repeat(auto-fill,minmax(160px,1fr))}
            :root{--title-width:clamp(220px,80%,680px)}
            .site-card{padding:15.9px 21.5px}
        }
        @media screen and (max-width:600px){
            header.title-box{font-size:1.82rem;letter-spacing:2px}
            .site-card{padding:16px 14px}
            .banner h2{font-size:1rem}
            .category-btn{font-size:.87rem;padding:8px 12px}
            .site-grid{gap:14.8px 10.4px}
            :root{--title-width:clamp(200px,90%,520px)}
        }
        @media (prefers-reduced-motion:reduce){#starfield{will-change:auto}}
    </style>
</head>
<body>
    <canvas id="starfield" aria-hidden="true"></canvas>

    <div class="container">
        <header class="title-box">ä¸æƒ³çœ‹ç‰‡</header>

        <div class="banner">
            <h2 class="title-box">ä¼˜é€‰å…¨çƒå½±è§†èµ„æº</h2>
        </div>

        <div class="category-btns">
            <button class="category-btn" id="btn-pan" data-cat="pan">ç½‘ç›˜</button>
            <button class="category-btn active" id="btn-online" data-cat="online">åœ¨çº¿</button>
            <button class="category-btn" id="btn-bt" data-cat="bt">BT</button>
        </div>

        <div class="grid-wrapper">
            <div class="site-grid" id="siteGrid"></div>

            <div id="embyBox" class="emby-box" aria-hidden="true">
                <div id="embyCard" class="card" role="region" aria-label="æµ®å±‚è¯´æ˜" tabindex="-1">
                    <h3>Embyæœ</h3>
                    <p>å¦‚æœä½ åŒå€¦äº†è§†é¢‘ç½‘ç«™å¤šå…ƒçš„å¹¿å‘Šå’Œæ¨¡ç³Šä¸æ¸…çš„ç”»è´¨ï¼ŒEmbyæœä¼šæ˜¯ä¸é”™çš„é€‰æ‹©ã€‚<br>Embyæœå¯å¤§è‡´åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š</p>
                    <ul>
                        <li>å…¬ç›Šæœï¼šæ— éœ€ä»˜è´¹ï¼Œä½†å¯èƒ½æœ‰ä¸€å®šå…¥æœé—¨æ§›</li>
                        <a href="https://intro.bgp.yt/" target="_blank" rel="noopener noreferrer">äºŒæ¬¡å…ƒEmby</a>ã€
                        <a href="https://t.me/embyxk" target="_blank" rel="noopener noreferrer">å…¬ç›Šæœæ˜Ÿç©ºæŒ‡å—</a>ã€
                        <a href="https://t.me/FreeEmbyGuide" target="_blank" rel="noopener noreferrer">å…¬ç›Šä¸å®Œå…¨æŒ‡åŒ—</a>
                        <li>ä»˜è´¹æœï¼šéœ€è¦ä»˜è´¹ï¼Œä½†æœåŠ¡ä¼šç›¸å¯¹æ¯”è¾ƒç¨³å®š</li>
                        <a href="https://plan.emby.moe/" target="_blank" rel="noopener noreferrer">1111Emby</a>ã€
                        <a href="https://micu.hk/archives/emby-users" target="_blank" rel="noopener noreferrer">MICU</a>ã€
                        <a href="https://t.me/Emby_Navigation" target="_blank" rel="noopener noreferrer">ä»˜è´¹Embyå¯¼èˆª</a>
                    </ul>
                    <p>æ³¨æ„äº‹é¡¹ï¼š</p>
                    <ul>
                        <li>æ–‡ä¸­æåˆ°çš„Embyæœä»…ä½œä¸ºç¤ºä¾‹ï¼Œä¸æ˜¯å¹¿å‘Šï¼Œè·‘è·¯ç®—ä½ å€’éœ‰</li>
                        <li>è´­ä¹°å‰ç¡®ä¿ä½ å¯ä»¥è®¿é—®ç›¸å…³Embyæœçº¿è·¯ï¼Œæˆ–å’¨è¯¢æœä¸»çº¿è·¯æ˜¯å¦å¯ä»¥ç›´è¿</li>
                        <li>è¯¦ç»†æ•™ç¨‹è¯·è®¿é—®ï¼š<a href="https://emby.wiki/zh/home" target="_blank" rel="noopener noreferrer">https://emby.wiki</a></li>
                    </ul>
                </div>
            </div>

            <template id="okTemplate">
                <h3>OKå½±è§†</h3>
                <p>OKå½±è§†/TVBoxä½¿ç”¨èµ·æ¥å’ŒEmbyå·®ä¸å¤šï¼Œä¸€èˆ¬å¡«å†™å¥½é…ç½®æ¥å£çš„åœ°å€å°±å¯ä»¥äº†ã€‚<br>è¯¦ç»†æ•™ç¨‹å’Œç›¸å…³èµ„æºå¯è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼š</p>
                <ul>
                    <li><a href="https://blog.ccino.org/p/tvbox-tv-version-installation-and-configuration-complete-guide/" target="_blank" rel="noopener noreferrer">TVBoxç”µè§†ç‰ˆå®‰è£…é…ç½®å…¨æŒ‡å—</a></li>
                    <li><a href="https://t.me/tvb_ys" target="_blank" rel="noopener noreferrer">TVB/å½±è¦–(OK) ç”µæŠ¥é¢‘é“</a></li>
                    <li><a href="https://github.com/qist/tvbox" target="_blank" rel="noopener noreferrer">OKå½±è§† å„ç§å®¢æˆ·ç«¯å’Œé…ç½®æ¥å£</a></li>
                    <li><a href="https://www.é¥­å¤ªç¡¬.com" target="_blank" rel="noopener noreferrer">é¥­å¤ªç¡¬ é…ç½®æ¥å£å¯¼èˆª</a></li>
                </ul>
            </template>
        </div>

        <div class="notes">
            <li>
                æ³¨ï¼šEE3 é‚€è¯·ç ï¼š <a style="color: #ff5630;">FMHY</a> æ¨èä½¿ç”¨ <a href="https://4get.canine.tools/web?s=Vivaldiæµè§ˆå™¨" target="_blank">Vivaldiæµè§ˆå™¨</a> ç§‘å­¦è®¿é—®
                <br>å¤‡ä»½ç½‘å€ï¼š<a href="https://www.bxkp.org" target="_blank">www</a>ã€<a href="https://v.bxkp.org" target="_blank">Vercel</a>ã€<a href="https://bxkp.netlify.app" target="_blank">Netlify</a>
            </li>
        </div>

        <div class="centered-backup-btn">
            <button id="embyBtn" class="backup-btn-large" data-type="emby">Embyæœ</button>
            <button id="okBtn" class="backup-btn-large" data-type="ok">OKå½±è§†</button>
        </div>

        <footer>
            Made with â¤ï¸
            <a href="https://github.com/kanpianer/pianer" target="_blank">Github</a>
            <a href="https://app.affine.pro/workspace/43839213-da83-415f-98f9-204fcd910d54/8UjZEIrLtL-PHOqZwH7b4" target="_blank">ç½‘ç«™å¤‡ä»½</a>
        </footer>
    </div>

<script>
    const SITES = [
        {name:"å‚é•¿èµ„æº",main_url:"https://www.cz4k.com/",backup_url:"https://www.czzy.site/",tags:["åœ¨çº¿","BT"]},
        {name:"NOè§†é¢‘",main_url:"https://www.novipnoad.cc/",backup_url:"https://findno.tv/",tags:["åœ¨çº¿"]},
        {name:"ä¸¤ä¸ªBT",main_url:"https://www.bttwo.me",backup_url:"https://bttwo.vip/",tags:["åœ¨çº¿",""]},
        {name:"ä¿®ç½—å½±è§†",main_url:"https://xl01.com.de/",backup_url:"https://xlys.me/",tags:["åœ¨çº¿","BT"]},
        {name:"è§‚å½± GYING",main_url:"https://gyg.la/",backup_url:"https://gyg.si/",tags:["ç½‘ç›˜","BT","åœ¨çº¿"]},
        {name:"GoPlay",main_url:"https://goplay.su/",backup_url:"https://discord.com/invite/yY2P3DQR8S",tags:["åœ¨çº¿"]},
        {name:"è¶£ç›˜|ä¸ƒç±³è“",main_url:"https://pan.mediy.cn",backup_url:"https://al.chirmyram.com",tags:["åœ¨çº¿"]},
        {name:"ç©å¶å“¥å“¥",main_url:"https://www.wogg.one",backup_url:"",tags:["ç½‘ç›˜"]},
        {name:"è€K",main_url:"https://docs.qq.com/doc/DTk5EaVdWY2R6ZnBk",backup_url:"",tags:["ç½‘ç›˜"]},
        {name:"PanHub",main_url:"https://www.panhub.com.cn",backup_url:"",tags:["ç½‘ç›˜"]},
        {name:"æ··åˆç›˜",main_url:"https://hunhepan.com/search",backup_url:"https://hhp.panso.me",tags:["ç½‘ç›˜"]},
        {name:"PanSearch",main_url:"https://pansearch.me/",backup_url:"",tags:["ç½‘ç›˜"]},
        {name:"çˆ±ç›¼",main_url:"https://www.aipan.me",backup_url:"",tags:["ç½‘ç›˜"]},
        {name:"é˜¿é‡Œäº‘èµ„æº",main_url:"https://slowread.net/",backup_url:"",tags:["ç½‘ç›˜"]},
        {name:"ShowBox",main_url:"https://www.showbox.media/",backup_url:"",tags:["ç½‘ç›˜"]},
        {name:"AGEåŠ¨æ¼«",main_url:"https://www.agedm.io/",backup_url:"http://www.age.tv/",tags:["åœ¨çº¿"]},
        {name:"EE3",main_url:"https://ee3.me/",backup_url:"https://rips.cc/",tags:["åœ¨çº¿"]},
        {name:"Cineby",main_url:"https://www.cineby.gd/",backup_url:"https://www.fmovies.gd/",tags:["åœ¨çº¿"]},
        {name:"Cinemaos",main_url:"https://cinemaos.live",backup_url:"https://discord.com/invite/38yFnFCJnA",tags:["åœ¨çº¿"]},
        {name:"Heartive",main_url:"https://heartive.pages.dev/",backup_url:"heartive@vjuum.com",tags:["åœ¨çº¿"]},
        {name:"BEECH",main_url:"https://www.beech.watch",backup_url:"https://mocine.cam/",tags:["åœ¨çº¿"]},
        {name:"Mapple",main_url:"https://mapple.mov/",backup_url:"https://mapple.site/",tags:["åœ¨çº¿"]},
        {name:"P-Stream",main_url:"https://pstream.mov",backup_url:"https://discord.com/invite/jZ6kkzADWS",tags:["åœ¨çº¿"]},
        {name:"BTä¹‹å®¶",main_url:"https://1lou.one/",backup_url:"https://1lou.cc/",tags:["BT","ç½‘ç›˜"]},
        {name:"ç£åŠ›ç†Š",main_url:"https://www.cilixiong.org",backup_url:"https://www.cilixiong.cc",tags:["BT"]},
        {name:"ç£åŠ›å¸",main_url:"https://cldcld.cc",backup_url:"https://cldcld.top",tags:["BT"]},
        {name:"1337X",main_url:"https://1337x.to/",backup_url:"https://1337x-status.org/",tags:["BT"]},
        {name:"YTS",main_url:"https://yts.mx/",backup_url:"https://gosites.org/yts",tags:["BT"]},
        {name:"EXT",main_url:"https://ext.to/",backup_url:"",tags:["BT"]},
        {name:"BDigg",main_url:"https://btdig.com/",backup_url:"",tags:["BT"]},
        {name:"Knaben",main_url:"https://knaben.org/",backup_url:"http://knabenxyzjl3bt5al7awroewfkg37x6duutapjytdib4w42mk2kiqpid.onion/",tags:["BT"]},
        {name:"iDope",main_url:"https://idope.hair",backup_url:"",tags:["BT"]},
        {name:"ACG.RIP",main_url:"https://acg.rip",backup_url:"",tags:["BT"]},
        {name:"LimeTorrents",main_url:"https://www.limetorrents.asia",backup_url:"https://limetorrent.si/",tags:["BT"]},
        {name:"ExtraTorrent",main_url:"https://extratorrent.st",backup_url:"",tags:["BT"]},
    ];

    let currentCategory = 'online';
    let infoActive = false;
    let currentInfoType = null;

    const gridEl = document.getElementById('siteGrid');
    const embyBox = document.getElementById('embyBox');
    const embyCard = document.getElementById('embyCard');
    const originalEmbyHTML = embyCard ? embyCard.innerHTML : '';
    const btns = document.querySelectorAll('.category-btn');

    function switchCategory(category){
        currentCategory = category;
        btns.forEach(b => b.classList.toggle('active', b.dataset.cat === category));
        if (infoActive) hideInfo(false);
        renderGrid();
    }

    function renderGrid(){
        if(!gridEl) return;
        gridEl.innerHTML = '';
        const tag = currentCategory === 'online' ? 'åœ¨çº¿' : currentCategory === 'pan' ? 'ç½‘ç›˜' : 'BT';
        const filtered = SITES.filter(s => s.tags.includes(tag));
        filtered.forEach(site => {
            const card = document.createElement('div');
            card.className = 'site-card';
            card.onclick = () => window.open(site.main_url, '_blank');

            const link = document.createElement('a');
            link.className = 'site-name';
            link.textContent = site.name;
            link.href = site.main_url;
            link.target = '_blank';
            link.rel = 'noopener noreferrer';
            link.addEventListener('click', e => e.stopPropagation());
            card.appendChild(link);

            const hasBackup = site.backup_url && site.backup_url.trim().length > 0;
            const backup = document.createElement('a');
            backup.className = hasBackup ? 'backup-link-btn' : 'backup-none-btn';
            backup.textContent = hasBackup ? 'å¤‡ä»½ç½‘å€' : 'æ²¡æœ‰å¤‡ä»½';
            backup.href = hasBackup ? site.backup_url : 'https://app.affine.pro/workspace/43839213-da83-415f-98f9-204fcd910d54/8UjZEIrLtL-PHOqZwH7b4';
            backup.target = '_blank';
            backup.rel = 'noopener noreferrer';
            backup.addEventListener('click', e => e.stopPropagation());
            card.appendChild(backup);

            gridEl.appendChild(card);
        });
    }

    renderGrid();

    function showInfo(type){
        if(!embyBox || !embyCard) return;
        if(type === 'emby'){
            embyCard.innerHTML = originalEmbyHTML;
            embyCard.setAttribute('aria-label','Embyæœè¯´æ˜');
        }else{
            const tpl = document.getElementById('okTemplate');
            embyCard.innerHTML = tpl ? tpl.innerHTML : '<h3>OKå½±è§†</h3><p>OKå½±è§†è¯´æ˜æ–‡å­—</p>';
            embyCard.setAttribute('aria-label','OKå½±è§†è¯´æ˜');
        }
        embyBox.classList.add('show');
        embyBox.setAttribute('aria-hidden','false');
        gridEl.classList.add('faded');

        const isMobile = window.matchMedia && window.matchMedia('(max-width:900px)').matches;
        setTimeout(() => {
            if(isMobile){
                const rect = embyCard.getBoundingClientRect();
                const scrollY = window.scrollY || window.pageYOffset || document.documentElement.scrollTop || 0;
                const targetTop = Math.max(0, Math.floor(scrollY + rect.top - 12));
                window.scrollTo({top:targetTop,behavior:'smooth'});
            }
            embyCard.setAttribute('tabindex','-1');
            try{ embyCard.focus && embyCard.focus({preventScroll:true}); }catch(e){}
        },60);
        infoActive = true;
        currentInfoType = type;
    }

    function hideInfo(hideWithAnimation = true){
        if(!embyBox || !embyCard) return;
        embyBox.classList.remove('show');
        embyBox.setAttribute('aria-hidden','true');
        if(hideWithAnimation) requestAnimationFrame(() => gridEl.classList.remove('faded'));
        else gridEl.classList.remove('faded');

        try{
            const embyBtn = document.getElementById('embyBtn');
            const okBtn = document.getElementById('okBtn');
            if(currentInfoType === 'ok' && okBtn) okBtn.focus({preventScroll:true});
            else if(embyBtn) embyBtn.focus({preventScroll:true});
        }catch(e){}
        infoActive = false;
        currentInfoType = null;
    }

    document.getElementById('embyBtn')?.addEventListener('click', () => { toggleInfo('emby'); });
    document.getElementById('okBtn')?.addEventListener('click', () => { toggleInfo('ok'); });

    document.querySelectorAll('.category-btn').forEach(btn => btn.addEventListener('click', e => {
        switchCategory(btn.dataset.cat);
    }));

    function toggleInfo(type){
        if(!infoActive || currentInfoType !== type) showInfo(type);
        else hideInfo(true);
    }

    ['embyBtn','okBtn'].forEach(id => {
        const el = document.getElementById(id);
        if(!el) return;
        el.addEventListener('keydown', e => {
            if(e.key === 'Enter' || e.key === ' '){
                e.preventDefault();
                toggleInfo(el.dataset.type);
            }
        });
    });
</script>

<script>
(function(){
    const canvas = document.getElementById('starfield');
    if(!canvas) return;
    const ctx = canvas.getContext('2d',{alpha:true});
    let stars = [], width=0, height=0, dpr=1, rafId=null;

    function rand(min,max){return min + Math.random()*(max-min)}

    function generateStars(){
        stars = [];
        const vw = Math.max(1, window.innerWidth);
        const vh = Math.max(1, window.innerHeight);
        const area = vw * vh;
        let count = Math.round(area / 24000);
        count = Math.max(20, Math.min(count, 200));
        for(let i=0;i<count;i++){
            const sizeBias = Math.pow(Math.random(),2);
            const r = 0.5 + sizeBias * 2.6;
            stars.push({
                x: Math.random()*vw,
                y: Math.random()*vh,
                r,
                baseAlpha: 0.35 + Math.random()*0.85,
                twinkleSpeed: 0.6 + Math.random()*2.2,
                phase: Math.random()*Math.PI*2,
                rotation: Math.random()*Math.PI*2,
                colorShift: (Math.random()*40)-10
            });
        }
        const bigCount = Math.round(count*0.01);
        for(let j=0;j<bigCount;j++){
            const r = 2.8 + Math.random()*4.2;
            stars.push({
                x: Math.random()*vw,
                y: Math.random()*vh,
                r,
                baseAlpha: 0.7 + Math.random()*0.5,
                twinkleSpeed: 0.3 + Math.random()*1.2,
                phase: Math.random()*Math.PI*2,
                rotation: Math.random()*Math.PI*2,
                colorShift: (Math.random()*40)-10
            });
        }
    }

    function resizeCanvas(){
        dpr = window.devicePixelRatio || 1;
        canvas.style.width = window.innerWidth + 'px';
        canvas.style.height = window.innerHeight + 'px';
        canvas.width = Math.max(1, Math.floor(window.innerWidth * dpr));
        canvas.height = Math.max(1, Math.floor(window.innerHeight * dpr));
        ctx.setTransform(dpr,0,0,dpr,0,0);
        width = window.innerWidth;
        height = window.innerHeight;
        generateStars();
        draw(0);
    }

    function drawFourPointStar(x,y,r,alpha,rotation){
        ctx.save();
        ctx.translate(x,y);
        ctx.rotate(rotation);
        if(r>1.6){
            const glowR = Math.max(10, r*5.0);
            const grad = ctx.createRadialGradient(0,0,0,0,0,glowR);
            grad.addColorStop(0, `rgba(255,255,255,${Math.min(1, alpha*1.0)})`);
            grad.addColorStop(0.12, `rgba(255,240,220,${alpha*0.26})`);
            grad.addColorStop(0.4, `rgba(200,220,255,${alpha*0.06})`);
            grad.addColorStop(1,'rgba(0,0,0,0)');
            ctx.fillStyle = grad;
            ctx.beginPath(); ctx.arc(0,0,glowR,0,Math.PI*2); ctx.fill();
        }
        const spikes = 4;
        const longR = r*3.8, shortR = r*1.6;
        ctx.beginPath();
        for(let i=0;i<spikes*2;i++){
            const angle = (Math.PI/spikes)*i;
            const radius = (i%2===0)?longR:shortR;
            const px = Math.cos(angle - Math.PI/2)*radius;
            const py = Math.sin(angle - Math.PI/2)*radius;
            i===0?ctx.moveTo(px,py):ctx.lineTo(px,py);
        }
        ctx.closePath();
        ctx.fillStyle = `rgba(255,255,255,${alpha})`;
        ctx.fill();

        ctx.beginPath();
        const cLong = r*1.1, cShort = r*0.5;
        for(let i=0;i<spikes*2;i++){
            const angle = (Math.PI/spikes)*i;
            const radius = (i%2===0)?cLong:cShort;
            const px = Math.cos(angle - Math.PI/2)*radius;
            const py = Math.sin(angle - Math.PI/2)*radius;
            i===0?ctx.moveTo(px,py):ctx.lineTo(px,py);
        }
        ctx.closePath();
        ctx.fillStyle = `rgba(255,255,255,${Math.min(1, alpha*1.25)})`;
        ctx.fill();
        ctx.restore();
    }

    function draw(timeMs){
        const t = (timeMs || 0)/1000;
        ctx.clearRect(0,0,width,height);
        for(let i=0;i<stars.length;i++){
            const s = stars[i];
            const tw = 0.5 + 0.5 * Math.sin(s.phase + t * s.twinkleSpeed * 1.5);
            const amplitudeMultiplier = 1.05 * 1.4;
            const alpha = Math.max(0, Math.min(1, s.baseAlpha * (0.25 + amplitudeMultiplier * tw)));
            const rScale = 1 + (0.45 * 1.4) * Math.sin(s.phase * 1.3 + t * s.twinkleSpeed * 1.6);
            const drawR = Math.max(0.35, s.r * rScale);
            const rotation = s.rotation + Math.sin(t * s.twinkleSpeed * 0.3 + s.phase) * 0.15;
            drawFourPointStar(s.x, s.y, drawR, alpha, rotation);
        }
    }

    let reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    function animate(timestamp){
        draw(timestamp);
        rafId = window.requestAnimationFrame(animate);
    }

    resizeCanvas();
    window.addEventListener('resize', () => {
        clearTimeout(window._starResizeTimeout);
        window._starResizeTimeout = setTimeout(resizeCanvas, 120);
    });

    if(!reduceMotion){
        rafId = window.requestAnimationFrame(animate);
        if(window.matchMedia){
            const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
            mq.addEventListener && mq.addEventListener('change', e => {
                reduceMotion = e.matches;
                if (reduceMotion){ cancelAnimationFrame(rafId); rafId = null; draw(0); }
                else if(!rafId) rafId = requestAnimationFrame(animate);
            });
        }
    }else{
        draw(0);
    }
})();
</script>
</body>
</html>
